<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Password Strength Checker</title>
  <style>
    :root {
      --bg: #0b1020;
      --card: #141b34;
      --muted: #9aa4bf;
      --text: #e7ecff;
      --ok: #4caf50;
      --warn: #ffc107;
      --bad: #ff5252;
      --info: #5ac8fa;
      --accent: #7c5cff;
    }
    * { box-sizing: border-box; }
    html, body {
      height: 100%;
      margin: 0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      color: var(--text);
      background: radial-gradient(1200px 800px at 70% -10%, #19224a, var(--bg));
    }
    .wrap {
      max-width: 840px;
      margin: 48px auto;
      padding: 0 16px;
    }
    .card {
      background: linear-gradient(180deg, rgba(255,255,255,0.03), transparent 120px), var(--card);
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 16px;
      padding: 24px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.25);
    }
    h1 {
      font-size: 28px;
      margin: 0 0 8px;
      line-height: 1.2;
      letter-spacing: 0.2px;
    }
    p.muted { color: var(--muted); margin-top: 0; }
    .row { display: grid; gap: 16px; }
    @media (min-width: 640px) {
      .row { grid-template-columns: 1fr 280px; align-items: start; }
    }
    .input {
      background: #0f1630;
      border: 1px solid rgba(255,255,255,0.08);
      padding: 12px 14px;
      border-radius: 12px;
      color: var(--text);
      width: 100%;
      font-size: 16px;
      outline: none;
      transition: border .15s ease;
    }
    .input:focus { border-color: var(--accent); box-shadow: 0 0 0 4px rgba(124,92,255,0.15); }
    .meter {
      height: 14px;
      background: #0f1630;
      border-radius: 999px;
      overflow: hidden;
      border: 1px solid rgba(255,255,255,0.08);
      position: relative;
    }
    .fill {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, #ff5252, #ffc107, #4caf50);
      transition: width .25s ease;
    }
    .score-label { font-weight: 600; letter-spacing: .2px; }
    .chips { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 10px; }
    .chip {
      font-size: 12px;
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(255,255,255,0.08);
      border: 1px solid rgba(255,255,255,0.08);
      color: var(--muted);
    }
    .chip.ok { color: #b8f5c0; border-color: rgba(76,175,80,0.45); }
    .chip.warn { color: #ffe08a; border-color: rgba(255,193,7,0.45); }
    .chip.bad { color: #ff9a9a; border-color: rgba(255,82,82,0.45); }
    .panel {
      background: #0f1630;
      border: 1px dashed rgba(255,255,255,0.15);
      padding: 14px;
      border-radius: 12px;
      color: var(--muted);
    }
    .aside { position: sticky; top: 16px; }
    ul { margin: 10px 0 0 18px; }
    .switch {
      display: inline-flex; align-items: center; gap: 10px; cursor: pointer; user-select: none;
      color: var(--muted); font-size: 14px;
    }
    .switch input { display: none; }
    .slider {
      width: 44px; height: 24px; border-radius: 999px; background: #24305f; position: relative; border: 1px solid rgba(255,255,255,0.12);
    }
    .slider::after {
      content: ""; position: absolute; top: 2px; left: 2px; width: 18px; height: 18px; border-radius: 50%; background: white; transition: transform .2s ease;
    }
    .switch input:checked + .slider { background: #2d885a; }
    .switch input:checked + .slider::after { transform: translateX(20px); }
    .file {
      display: inline-flex; align-items: center; gap: 10px; margin-top: 6px; font-size: 14px; color: var(--info);
    }
    .footer {
      margin-top: 18px; display: flex; justify-content: space-between; align-items: center; gap: 12px; color: var(--muted); font-size: 12px;
    }
    code.kbd {
      background: rgba(255,255,255,0.08);
      padding: 2px 6px;
      border-radius: 6px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
      color: #bcd0ff;
      border: 1px solid rgba(255,255,255,0.1);
    }
    .hidden { display: none; }

  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>Password Strength Checker</h1>
      <p class="muted"></p>

      <div class="row">
        <div>
          <label for="pw" class="muted">Password</label>
          <input id="pw" class="input" type="password" autocomplete="off" spellcheck="false" placeholder="Type here…" />
          <div style="height:10px"></div>
          <div class="meter" aria-label="password strength meter"><div id="fill" class="fill"></div></div>
          <div style="height:6px"></div>
          <div><span class="score-label" id="scoreLabel">Score: 0 / 4</span> &nbsp; <span class="muted" id="entropyLabel">Entropy: 0 bits</span></div>
          <div class="chips" id="chips"></div>

          <div style="height:18px"></div>
          <div class="panel">
            <strong>Why this score?</strong>
            <ul id="reasons"></ul>
          </div>

          <div class="footer">
            <label class="switch">
              <input type="checkbox" id="showToggle" />
              <span class="slider" aria-hidden="true"></span>
              <span>Show password</span>
            </label>

          </div>
        </div>

        <aside class="aside">
          <div class="panel">
            <strong>Guidance</strong>
            <ul>
              <li>Favor <em>length</em> over complexity (e.g., passphrases).</li>
              <li>Avoid dictionary words, names, keyboard sequences, and dates.</li>
              <li>Don’t reuse passwords; use a password manager.</li>
              <li>Enable MFA wherever available.</li>
            </ul>
          </div>
          <div style="height:12px"></div>

        </aside>
      </div>
    </div>
  </div>

  <script>
    // --- Lightweight offline estimator ---
    // Entropy calculation is based on estimated character set size & length,
    // minus penalties for common weaknesses. This is not a substitute for
    // formal audits, but provides practical heuristic feedback offline.
    const pwInput = document.getElementById('pw');
    const fill = document.getElementById('fill');
    const scoreLabel = document.getElementById('scoreLabel');
    const entropyLabel = document.getElementById('entropyLabel');
    const reasonsEl = document.getElementById('reasons');
    const chipsEl = document.getElementById('chips');
    const showToggle = document.getElementById('showToggle');
    const wordlistInput = document.getElementById('wordlist');

    // Small default blacklist to catch very common passwords & patterns.
    // Admins can load a larger list via the "Load blacklist" option.
    let blacklist = new Set([
      "123456","password","123456789","qwerty","abc123","111111","letmein","welcome","admin","iloveyou",
      "123123","monkey","dragon","football","baseball","shadow","master","sunshine","ashley","bailey",
      "login","princess","qwertyuiop","solo","passw0rd","starwars", "GGRM", 'ggrm'
    ]);

    showToggle.addEventListener('change', () => {
      pwInput.type = showToggle.checked ? 'text' : 'password';
      pwInput.focus();
    });

    document.querySelector('.file').addEventListener('click', () => wordlistInput.click());
    wordlistInput.addEventListener('change', async (e) => {
      const file = e.target.files?.[0];
      if (!file) return;
      const text = await file.text();
      const words = text.split(/[\r\n,;]+/).map(w => w.trim().toLowerCase()).filter(Boolean);
      words.forEach(w => blacklist.add(w));
      notify("Custom blacklist loaded (" + words.length + " entries).");
      evaluate();
    });

    function notify(msg) {
      const chip = document.createElement('span');
      chip.className = 'chip ok';
      chip.textContent = msg;
      chipsEl.prepend(chip);
      setTimeout(() => chip.remove(), 4500);
    }

    function estimateEntropy(password) {
      if (!password) return { bits: 0, charSpace: 0 };

      let charSpace = 0;
      const sets = {
        lower: /[a-z]/.test(password),
        upper: /[A-Z]/.test(password),
        digit: /\d/.test(password),
        symbol: /[^A-Za-z0-9]/.test(password),
      };
      if (sets.lower) charSpace += 26;
      if (sets.upper) charSpace += 26;
      if (sets.digit) charSpace += 10;
      if (sets.symbol) charSpace += 33; // conservative printable symbols

      // Fallback: if all characters are the same type, still give minimum variety
      if (charSpace === 0) charSpace = 1;

      // Base entropy (assuming IID over chosen set)
      let bits = Math.log2(charSpace) * password.length;

      // Penalties for weaknesses
      const lowers = password.toLowerCase();
      const reasons = [];

      // Very common blacklisted passwords (case-insensitive)
      if (blacklist.has(lowers)) {
        bits -= 24;
        reasons.push("Appears in a common password list.");
      }

      // Contains blacklisted word as substring (for short lists only)
      for (const word of blacklist) {
        if (word.length >= 4 && lowers.includes(word)) {
          bits -= 12;
          reasons.push(`Contains a common word: “${word}”.`);
          break;
        }
      }

      // Sequential or repeated character patterns
      if (/(.)\1{2,}/.test(password)) { bits -= 10; reasons.push("Repeating characters."); }
      if (/(?:0123|1234|2345|3456|4567|5678|6789)/.test(lowers) ||
          /(?:abcd|bcde|cdef|defg|efgh|fghi|ghij|hijk|ijkl|jklm|klmn|lmno|mnop|nopq|opqr|pqrs|qrst|rstu|stuv|tuvw|uvwx|vwxy|wxyz)/.test(lowers)) {
        bits -= 10; reasons.push("Sequential characters (e.g., 'abcd', '1234').");
      }

      // Keyboard patterns
      const kb = ["qwerty","asdf","zxcv","qaz","wsx","1q2w3e","qwertyuiop","asdfghjkl","zxcvbnm"];
      if (kb.some(k => lowers.includes(k))) { bits -= 10; reasons.push("Keyboard pattern detected."); }

      // Leetspeak normalization check (e.g., p@ssw0rd)
      const deLeet = lowers
        .replace(/[@$]/g, 'a')
        .replace(/[!1]/g, 'i')
        .replace(/[3]/g, 'e')
        .replace(/[0]/g, 'o')
        .replace(/[5]/g, 's')
        .replace(/[7]/g, 't');
      if (blacklist.has(deLeet)) { bits -= 16; reasons.push("Looks like an obfuscated common word."); }

      // Bound the entropy to a minimum floor of 0 and reasonable cap
      bits = Math.max(0, Math.min(bits, 256));
      return { bits, charSpace, reasons };
    }

    function scoreFromBits(bits, length) {
      // Map entropy to 0–4 score using practical thresholds
      // and length influence to favor passphrases.
      const lenBonus = Math.max(0, (length - 12) * 1.2);
      const adj = bits + lenBonus;

      if (adj >= 90) return 4;     // Excellent
      if (adj >= 70) return 3;     // Good
      if (adj >= 45) return 2;     // Fair
      if (adj >= 25) return 1;     // Weak
      return 0;                    // Very weak
    }

    function setMeter(score) {
      const pct = [5, 25, 60, 80, 100][score] || 0;
      fill.style.width = pct + "%";
      fill.style.filter = `saturate(${0.9 + score * 0.2})`;
    }

    function formatBits(bits) {
      return bits.toFixed(1).replace(/\.0$/, "");
    }

    function evaluate() {
      const pw = pwInput.value || "";
      const { bits, reasons = [] } = estimateEntropy(pw);
      const score = scoreFromBits(bits, pw.length);

      setMeter(score);
      scoreLabel.textContent = `Score: ${score} / 4`;
      entropyLabel.textContent = `Entropy: ${formatBits(bits)} bits`;

      reasonsEl.innerHTML = "";
      const list = [...reasons];

      // Positive and negative chips
      chipsEl.innerHTML = "";
      const addChip = (text, cls) => {
        const el = document.createElement('span');
        el.className = `chip ${cls}`;
        el.textContent = text;
        chipsEl.appendChild(el);
      };

      // Base suggestions / affirmations
      if (pw.length >= 16) addChip("Great length (16+)", "ok"); else addChip("Try 16+ chars", "warn");
      if (/[A-Z]/.test(pw) && /[a-z]/.test(pw)) addChip("Mixed case", "ok"); else addChip("Add upper/lower", "warn");
      if (/\d/.test(pw)) addChip("Has numbers", "ok"); else addChip("Add numbers", "warn");
      if (/[^A-Za-z0-9]/.test(pw)) addChip("Has symbols", "ok"); else addChip("Add symbols", "warn");

      if (pw.length < 12) list.push("Short length. Aim for 14–16+ characters.");
      if (/^[A-Za-z]+$/.test(pw)) list.push("Only letters used.");
      if (/^\d+$/.test(pw)) list.push("Only digits used.");
      if (/^[^A-Za-z0-9]+$/.test(pw)) list.push("Only symbols used.");
      if (pw.length && pw.trim() !== pw) list.push("Leading or trailing spaces detected.");

      if (!pw) list.push("Start typing to see feedback.");

      for (const r of dedupe(list)) {
        const li = document.createElement('li');
        li.textContent = r;
        reasonsEl.appendChild(li);
      }
    }

    function dedupe(arr) {
      return [...new Set(arr)];
    }

    pwInput.addEventListener('input', evaluate);
    window.addEventListener('DOMContentLoaded', evaluate);
  </script>
</body>
</html>
